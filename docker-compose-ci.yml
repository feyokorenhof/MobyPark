services:
  db:
    ports: []          # do not publish 5432 on the runner
    restart: "no"      # optional; avoids “always” restart loops in CI
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U $${POSTGRES_USER} -d postgres"]
      interval: 2s
      timeout: 3s
      retries: 30

  api:
    ports: []          # not needed in CI
    command: ["sh", "-c", "sleep infinity"]  # keep container up for exec pytest
